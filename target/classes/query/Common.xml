<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.space.space.dao.CommonDAO">

	<!-- 게시물 전체 조회 (메인페이지 검색 쿼리) -->
	<select id="commonList" resultType="space">
		/* Space - spaceList */
		select sp_num, sp_file, sp_name, sp_address,
		sp_price
		from
		( select list.*, rownum as rnum
		from (
		select sp_num,
		sp_file, sp_name, sp_address, sp_price
		from tb_space
		<where>
			<if test="keyword != null and keyword != ''">
				sp_name like '%' || #{keyword} || '%'
			</if>
		</where>
		order by sp_num desc
		) list
		)
		<where>
			<if test="start_row != null and start_row != ''">
				<if test="end_row != null and end_row != ''">
					rnum between #{start_row} and #{end_row}
				</if>
			</if>
		</where>
	</select>


	<!-- 게시물 총 개수 -->
	<select id="commonListCnt" parameterType="common" resultType="int">
		<!-- Space - SpaceListCnt -->
		select nvl(count(1), 0) from
		( select list.*, rownum as rnum
		from(
		select * from tb_space
		<where>
			<if test="keyword != null and keyword != ''">
				sp_name like '%' || #{keyword} || '%'
			</if>
		</where>
		) list
		)

	</select>

		<!-- 상세 페이지를 위한 게시물 조회 -->
	<select id="commonDetail" parameterType="int" resultType="common">
		/* Board - spaceDetail */
		SELECT
			      sp_num, sp_type, sp_stock, sp_name, sp_price, sp_address,
			      sp_exposition, sp_file, sp_service, sp_traffic, sp_rest,
			      sp_reservation, sp_state
		FROM tb_space
		WHERE sp_num = #{sp_Num}
	</select>


</mapper>
